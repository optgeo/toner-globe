/// Transportation layers (roads, rail, etc.)
module toner.layers.Transportation

import "../config/Colors.pkl"
import "Base.pkl"

/// Railway lines
rail: LineLayer = new LineLayer {
  id = "rail"
  source = "openmaptiles"
  `source-layer` = "transportation"
  minzoom = 13
  filter = new { "all"; new { "=="; "class"; "rail" } }
  layout = new {
    ["visibility"] = "visible"
  }
  paint = new {
    ["line-color"] = new List {
      ["step"] = new List {
        new List { 13; Colors.transportation.rail_light }
        new List { 17; Colors.transportation.rail_dark }
      }
    }
    ["line-width"] = new List {
      ["step"] = new List {
        new List { 13; 0.85 }
        new List { 17; 2 }
      }
    }
  }
}

/// Railway hatching pattern
rail_hatch: LineLayer = new LineLayer {
  id = "rail_hatch"
  source = "openmaptiles"
  `source-layer` = "transportation"
  minzoom = 15
  filter = new { "all"; new { "=="; "class"; "rail" } }
  layout = new {
    ["visibility"] = "visible"
  }
  paint = new {
    ["line-color"] = Colors.transportation.rail_dark
    ["line-dasharray"] = new {
      ["interpolate"] = new List {
        "linear"
        new List { 15; new List { 0.2; 0.8 } }
        new List { 17; new List { 0.2; 1 } }
      }
    }
    ["line-width"] = new {
      ["interpolate"] = new List {
        "linear"
        new List { 15; 2 }
        new List { 17; 6 }
      }
    }
  }
}

/// Bridge areas
road_area_bridge: FillLayer = new FillLayer {
  id = "road_area_bridge"
  source = "openmaptiles"
  `source-layer` = "transportation"
  filter = new { "all"; new { "=="; "$type"; "Polygon" }; new { "=="; "brunnel"; "bridge" } }
  layout = new {
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["fill-antialias"] = true
    ["fill-color"] = "rgba(255, 255, 255, 1)"
    ["fill-opacity"] = 1
  }
}

/// Pier areas
road_area_pier: FillLayer = new FillLayer {
  id = "road_area_pier"
  source = "openmaptiles"
  `source-layer` = "transportation"
  filter = new { "all"; new { "=="; "$type"; "Polygon" }; new { "=="; "class"; "pier" } }
  layout = new {
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["fill-antialias"] = true
    ["fill-color"] = "rgba(255, 255, 255, 1)"
    ["fill-opacity"] = 1
  }
}

/// Pier lines
road_pier: LineLayer = new LineLayer {
  id = "road_pier"
  source = "openmaptiles"
  `source-layer` = "transportation"
  filter = new { "all"; new { "=="; "$type"; "LineString" }; new { "in"; "class"; "pier" } }
  layout = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["line-color"] = "rgba(255, 255, 255, 1)"
    ["line-width"] = new { "interpolate"; new { "exponential"; 1.2 }; new { "zoom" }; 15; 1; 17; 4 }
  }
}

/// Path lines
road_path: LineLayer = new LineLayer {
  id = "road_path"
  source = "openmaptiles"
  `source-layer` = "transportation"
  minzoom = 15
  filter = new { "all"; new { "=="; "$type"; "LineString" }; new { "=="; "class"; "path" } }
  layout = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["line-color"] = "rgba(255, 255, 255, 1)"
    ["line-width"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 14; 2; 17; 4 }
  }
}

/// Secondary roads
road_secondary: LineLayer = new LineLayer {
  id = "road_secondary"
  source = "openmaptiles"
  `source-layer` = "transportation"
  minzoom = 10
  filter = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "rail"; "path"; "primary" }
    new { "in"; "class"; "secondary"; "tertiary"; "minor"; "service" }
  }
  layout = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["line-color"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 10; Colors.transportation.road_secondary_light; 12; Colors.transportation.road_secondary_medium; 15; Colors.transportation.road_secondary_dark }
    ["line-width"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 13; 0.5; 15; 3; 17; 8 }
  }
}

/// Primary roads
road_primary: LineLayer = new LineLayer {
  id = "road_primary"
  source = "openmaptiles"
  `source-layer` = "transportation"
  minzoom = 8
  filter = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "rail"; "path" }
    new { "=="; "class"; "primary" }
  }
  layout = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["line-color"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 8; Colors.transportation.road_primary_light; 10; Colors.transportation.road_primary_medium; 17; Colors.transportation.road_primary_dark }
    ["line-width"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 12; 0.75; 15; 6; 17; 8 }
  }
}

/// Highway casing
road_highway_casing: LineLayer = new LineLayer {
  id = "road_highway_casing"
  source = "openmaptiles"
  `source-layer` = "transportation"
  minzoom = 8
  filter = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "path"; "rail" }
    new { "in"; "class"; "motorway"; "trunk" }
  }
  layout = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["line-color"] = new { "step"; new { "zoom" }; Colors.transportation.highway_casing_light; 10; Colors.transportation.highway_casing_white; 16; Colors.transportation.highway_casing_white }
    ["line-opacity"] = 1
    ["line-width"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 10; 4; 16; 16 }
  }
}

/// Highway center lines
road_highway: LineLayer = new LineLayer {
  id = "road_highway"
  source = "openmaptiles"
  `source-layer` = "transportation"
  minzoom = 6
  filter = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "path"; "rail" }
    new { "in"; "class"; "motorway"; "trunk" }
  }
  layout = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  metadata = new {}
  paint = new {
    ["line-color"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 6; Colors.transportation.highway_light; 10; Colors.transportation.highway_medium; 16; Colors.transportation.highway_dark }
    ["line-opacity"] = 1
    ["line-width"] = new { "interpolate"; new { "linear" }; new { "zoom" }; 7; 1; 10; 2; 16; 8 }
  }
}
