/// Basic layers for toner style
module toner.layers.Basic

import "../config/Colors.pkl"

/// Background layer
background: Dynamic = new {
  ["id"] = "background"
  ["type"] = "background"
  ["paint"] = new {
    ["background-color"] = Colors.background
  }
}

/// Water features
water: Dynamic = new {
  ["id"] = "water"
  ["type"] = "fill"
  ["source"] = "openmaptiles"
  ["source-layer"] = "water"
  ["filter"] = new {
    "all"
    new { "!="; "brunnel"; "tunnel" }
    new { "=="; "$type"; "Polygon" }
    new { "!="; "intermittent"; 1 }
  }
  ["layout"] = new {
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["fill-antialias"] = true
    ["fill-color"] = Colors.water
  }
}

/// Simple landcover layer
landcover: Dynamic = new {
  ["id"] = "landcover"
  ["type"] = "fill"
  ["source"] = "openmaptiles"
  ["source-layer"] = "landcover"
  ["maxzoom"] = 14
  ["layout"] = new {
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["fill-color"] = new {
      "case"
      new { "=="; new { "get"; "class" }; "grass" }
      Colors.landcover.grass_fill
      new { "=="; new { "get"; "class" }; "scrub" }
      Colors.landcover.scrub
      new { "=="; new { "get"; "class" }; "wood" }
      Colors.landcover.wood
      Colors.landcover.default
    }
    ["fill-opacity"] = 1.0
  }
}

/// Park layer
park: Dynamic = new {
  ["id"] = "park"
  ["type"] = "fill"
  ["source"] = "openmaptiles"
  ["source-layer"] = "park"
  ["minzoom"] = 6
  ["layout"] = new {
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["fill-color"] = Colors.landuse.park
    ["fill-opacity"] = new { 
      "step"
      new { "zoom" }
      0.8
      6; 0.6
      14; 0.4
    }
  }
}

/// Landuse layer
landuse: Dynamic = new {
  ["id"] = "landuse"
  ["type"] = "fill"
  ["source"] = "openmaptiles"
  ["source-layer"] = "landuse"
  ["minzoom"] = 5
  ["layout"] = new {
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["fill-color"] = Colors.landuse.default
    ["fill-opacity"] = new { 
      "step"
      new { "zoom" }
      0.7
      5; 0.6
      14; 0.4
    }
  }
}

/// Building layer
building: Dynamic = new {
  ["id"] = "building"
  ["type"] = "fill"
  ["source"] = "openmaptiles"
  ["source-layer"] = "building"
  ["minzoom"] = 13
  ["layout"] = new {
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["fill-antialias"] = true
    ["fill-color"] = Colors.building.light
    ["fill-opacity"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      13; 0.3
      15; 0.6
      17; 0.8
    }
  }
}

/// Rail layer
rail: Dynamic = new {
  ["id"] = "rail"
  ["type"] = "line"
  ["source"] = "openmaptiles"
  ["source-layer"] = "transportation"
  ["minzoom"] = 13
  ["filter"] = new { "all"; new { "=="; "class"; "rail" } }
  ["layout"] = new {
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["line-color"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      13; Colors.transportation.rail_light
      17; Colors.transportation.rail_dark
    }
    ["line-width"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      13; 0.85
      17; 2
    }
  }
}

/// Secondary roads
road_secondary: Dynamic = new {
  ["id"] = "road_secondary"
  ["type"] = "line"
  ["source"] = "openmaptiles"
  ["source-layer"] = "transportation"
  ["minzoom"] = 10
  ["filter"] = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "rail"; "path"; "primary" }
    new { "in"; "class"; "secondary"; "tertiary"; "minor"; "service" }
  }
  ["layout"] = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["line-color"] = new {
      "step"
      new { "zoom" }
      Colors.transportation.road_secondary_light
      10; Colors.transportation.road_secondary_medium
      12; Colors.transportation.road_secondary_medium_high
      15; Colors.transportation.road_secondary_dark
    }
    ["line-width"] = new {
      "step"
      new { "zoom" }
      0.5
      13; 3
      15; 8
      17; 10
    }
  }
}

/// Primary roads
road_primary: Dynamic = new {
  ["id"] = "road_primary"
  ["type"] = "line"
  ["source"] = "openmaptiles"
  ["source-layer"] = "transportation"
  ["minzoom"] = 8
  ["filter"] = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "rail"; "path" }
    new { "=="; "class"; "primary" }
  }
  ["layout"] = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["line-color"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      8; Colors.transportation.road_primary_light
      10; Colors.transportation.road_primary_medium
      17; Colors.transportation.road_primary_dark
    }
    ["line-width"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      12; 0.75
      15; 6
      17; 8
    }
  }
}

/// Highway casing
road_highway_casing: Dynamic = new {
  ["id"] = "road_highway_casing"
  ["type"] = "line"
  ["source"] = "openmaptiles"
  ["source-layer"] = "transportation"
  ["minzoom"] = 8
  ["filter"] = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "path"; "rail" }
    new { "in"; "class"; "motorway"; "trunk" }
  }
  ["layout"] = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["line-color"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      6; Colors.transportation.highway_casing_light
      10; Colors.transportation.highway_casing_white
      16; Colors.transportation.highway_casing_white_full
    }
    ["line-opacity"] = 1
    ["line-width"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      10; 4
      16; 16
    }
  }
}

/// Highway center
road_highway: Dynamic = new {
  ["id"] = "road_highway"
  ["type"] = "line"
  ["source"] = "openmaptiles"
  ["source-layer"] = "transportation"
  ["minzoom"] = 6
  ["filter"] = new { 
    "all"
    new { "=="; "$type"; "LineString" }
    new { "!in"; "class"; "pier"; "path"; "rail" }
    new { "in"; "class"; "motorway"; "trunk" }
  }
  ["layout"] = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["line-color"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      6; Colors.transportation.highway_light
      10; Colors.transportation.highway_medium
      16; Colors.transportation.highway_dark
    }
    ["line-opacity"] = 1
    ["line-width"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      7; 1
      10; 2
      16; 8
    }
  }
}

/// Country boundaries
boundary_country: Dynamic = new {
  ["id"] = "boundary_country"
  ["type"] = "line"
  ["source"] = "openmaptiles"
  ["source-layer"] = "boundary"
  ["minzoom"] = 3
  ["filter"] = new { "all"; new { "=="; "admin_level"; 2 }; new { "=="; "$type"; "LineString" } }
  ["layout"] = new {
    ["line-cap"] = "round"
    ["line-join"] = "round"
    ["visibility"] = "visible"
  }
  ["paint"] = new {
    ["line-color"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      3; Colors.boundary.country_light
      8; Colors.boundary.country_medium
      14; Colors.boundary.country_dark
    }
    ["line-width"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      3; 0.5
      8; 1.5
      14; 3
    }
    ["line-dasharray"] = new { 3; 2; 1; 2 }
  }
}

/// City labels
place_city: Dynamic = new {
  ["id"] = "place_city"
  ["type"] = "symbol"
  ["source"] = "openmaptiles"
  ["source-layer"] = "place"
  ["minzoom"] = 7
  ["filter"] = new { "all"; new { "=="; "class"; "city" }; new { "=="; "$type"; "Point" } }
  ["layout"] = new {
    ["text-field"] = new {
      "case"
      new { "has"; "name:ja" }
      new { "get"; "name:ja" }
      new { "get"; "name" }
    }
    ["text-font"] = new { "Noto Sans JP Regular"; "Open Sans Regular" }
    ["text-size"] = new {
      "interpolate"
      new { "linear" }
      new { "zoom" }
      7; 10
      10; 12
      14; 16
    }
    ["text-transform"] = "none"
    ["visibility"] = "visible"
    ["text-anchor"] = "center"
    ["text-offset"] = new { 0; 0 }
    ["text-max-width"] = 8
  }
  ["paint"] = new {
    ["text-color"] = Colors.text.primary
    ["text-halo-color"] = Colors.text.halo
    ["text-halo-width"] = 1.5
  }
}
